<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HR Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        background: #050B1A;
        font-family: 'Poppins', sans-serif;
        margin: 0;
        padding: 0;
        color: #CFE4FF;
    }
    h1 {
        text-align: center;
        color: #74A9FF;
        text-shadow: 0 0 12px #0058ff;
        margin-top: 25px;
    }
    .tab-container {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }
    .tab-container button {
        background: rgba(0,0,0,0.35);
        border: 1px solid #123;
        padding: 12px 25px;
        margin: 0 8px;
        border-radius: 14px;
        color: #9EC5FF;
        cursor: pointer;
        transition: 0.2s;
    }
    .tab-container button.active {
        background: #00308f;
        box-shadow: 0 0 10px #0058ff;
    }
    .kpi-row {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 40px;
    }
    .kpi-box {
        width: 260px;
        background: rgba(0,0,20,0.45);
        margin: 12px;
        padding: 22px;
        border-radius: 16px;
        text-align: center;
        border: 1px solid #0D1A40;
        box-shadow: 0 0 18px #00256b inset;
    }
    .kpi-title {
        color: #9EC5FF;
        font-size: 17px;
        margin-bottom: 5px;
    }
    .kpi-value {
        color: #fff;
        font-size: 42px;
        font-weight: 700;
        text-shadow: 0 0 8px #007bff;
    }
    .section-title {
        text-align: center;
        margin-top: 40px;
        margin-bottom: 15px;
        font-size: 22px;
        color: #9EC5FF;
        text-shadow: 0 0 8px #007bff;
    }
</style>
</head>

<body>

<h1>HR Dashboard</h1>

<div class="tab-container">
    <button class="active">Overview</button>
    <button>Employee Details</button>
    <button>Compensation</button>
</div>

<div class="kpi-row">
    <div class="kpi-box">
        <div class="kpi-title">Total Employees</div>
        <div class="kpi-value" id="totalEmployees">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">Active Employees</div>
        <div class="kpi-value" id="activeEmployees">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">Inactive Employees</div>
        <div class="kpi-value" id="inactiveEmployees">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">On Probation</div>
        <div class="kpi-value" id="onProbation">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">Probation Ending Soon</div>
        <div class="kpi-value" id="probationSoon">0</div>
    </div>
</div>

<h2 class="section-title">Employee Tenure Summary</h2>

<div class="kpi-row">
    <div class="kpi-box">
        <div class="kpi-title">Less than 1 Year</div>
        <div class="kpi-value" id="lessOne">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">1 – 2 Years</div>
        <div class="kpi-value" id="oneTwo">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">2 – 3 Years</div>
        <div class="kpi-value" id="twoThree">0</div>
    </div>
    <div class="kpi-box">
        <div class="kpi-title">3+ Years</div>
        <div class="kpi-value" id="threePlus">0</div>
    </div>
</div>

<script>
const API_URL = "https://hr-api.ashishoct34.workers.dev/";

async function loadData() {
    try {
        const res = await fetch(API_URL);
        const data = await res.json();
        const now = new Date();

        // === SUMMARY ===
        document.getElementById("totalEmployees").innerText = data.summary.total_employees;
        document.getElementById("activeEmployees").innerText = data.summary.active_employees;
        document.getElementById("inactiveEmployees").innerText = data.summary.inactive_employees;

        // On probation = status === "Probation"
        let prob = data.employees.filter(e => e.status === "Probation").length;
        document.getElementById("onProbation").innerText = prob;

        // Probation ending soon from API summary
        document.getElementById("probationSoon").innerText =
            data.summary.probation_next_30_days;

        // === TENURE (Active Employees Only) ===
        const less1 = data.employees.filter(e => {
            if (!e.joining_date || e.status !== "Active") return false;
            let join = new Date(e.joining_date);
            let yrs = (now - join) / (1000*60*60*24*365);
            return yrs < 1;
        }).length;

        const y1to2 = data.employees.filter(e => {
            if (!e.joining_date || e.status !== "Active") return false;
            let join = new Date(e.joining_date);
            let yrs = (now - join) / (1000*60*60*24*365);
            return yrs >= 1 && yrs < 2;
        }).length;

        const y2to3 = data.employees.filter(e => {
            if (!e.joining_date || e.status !== "Active") return false;
            let join = new Date(e.joining_date);
            let yrs = (now - join) / (1000*60*60*24*365);
            return yrs >= 2 && yrs < 3;
        }).length;

        const more3 = data.employees.filter(e => {
            if (!e.joining_date || e.status !== "Active") return false;
            let join = new Date(e.joining_date);
            let yrs = (now - join) / (1000*60*60*24*365);
            return yrs >= 3;
        }).length;

        document.getElementById("lessOne").innerText = less1;
        document.getElementById("oneTwo").innerText = y1to2;
        document.getElementById("twoThree").innerText = y2to3;
        document.getElementById("threePlus").innerText = more3;

    } catch (e) {
        console.error("Failed to load HR data:", e);
    }
}

window.onload = loadData;
</script>

</body>
</html>
